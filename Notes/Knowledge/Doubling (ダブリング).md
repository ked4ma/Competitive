#math #graph #math/doubling #graph/doubling
Doublingにもいくつかやり方がある
### 状態の遷移をそれなりのサイズの行列漸化式で表現できる場合
たとえば問題に対しての漸化式を以下のように表現できるとき、

$$
\begin{pmatrix}
  x_{i+1,0} \\
  x_{i+1,1} \\
  x_{i+1,2} \\
  x_{i+1,3} \\
  x_{i+1,4}
\end{pmatrix}
=
\begin{pmatrix}
  0 & 1 & 1 & 0 & 0 \\
  1 & 1 & 0 & 0 & 1 \\
  0 & 0 & 0 & 1 & 1 \\
  1 & 0 & 1 & 0 & 1 \\
  0 & 0 & 0 & 0 & 1
\end{pmatrix}
\begin{pmatrix}
  x_{i,0} \\
  x_{i,1} \\
  x_{i,2} \\
  x_{i,3} \\
  x_{i,4}
\end{pmatrix}
$$

$K$回操作したあとの値がほしいケース
このようなときは

$$
\begin{pmatrix}
  x_{K,0} \\
  x_{K,1} \\
  x_{K,2} \\
  x_{K,3} \\
  x_{K,4}
\end{pmatrix}
=
\begin{pmatrix}
  0 & 1 & 1 & 0 & 0 \\
  1 & 1 & 0 & 0 & 1 \\
  0 & 0 & 0 & 1 & 1 \\
  1 & 0 & 1 & 0 & 1 \\
  0 & 0 & 0 & 0 & 1
\end{pmatrix} ^ K
\begin{pmatrix}
  x_{0,0} \\
  x_{0,1} \\
  x_{0,2} \\
  x_{0,3} \\
  x_{0,4}
\end{pmatrix}
$$

というように遷移行列に対して$pow(K)$することで高速に求めることができる

### 遷移グラフとして表現される場合
![[Screenshot from 2025-12-16 02-06-54.png|200]] ![[Screenshot from 2025-12-16 02-07-06.png|200]] ![[Screenshot from 2025-12-16 02-07-14.png|200]]
画像(左)のようにグラフの状態遷移として表現される場合は、
- 各頂点から1回移動したとき
- 各頂点から2回移動したとき
- 各頂点から4回移動したとき
- 各頂点から8回移動したとき
- ...
と移動距離を2倍しながら考えることで高速に解ける
その際、次の移動距離の遷移を求めたい場合は
「頂点Aから4回移動 」= 「頂点Aから2回移動を2回行う」
が成り立つので、前回の遷移情報があれば$O(N)$で計算可能
$K$ 回移動する上でその移動距離の情報を使うかは単純に
「その移動距離と一致するbit部分が1か」で判断できる
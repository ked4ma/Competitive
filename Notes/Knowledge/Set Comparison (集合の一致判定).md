#set #set/comparison

ある集合A($x_1$, $x_2$, $\dots$, $x_n$ ), B($y_1$, $y_2$, $\dots$, $y_m$ ) があったとき、これらの一致判定をしたいことがある。
このときに利用できるテクニックにハッシュがあるが、その際ハッシュ設計時に衝突の確率保証をしてあげる必要がある。

それに使える概念として Schwartz-Zippel lemma (Schwartz-Zippelの補題)がある。
これはざっくり言うと、

> ある多項式$p(a_1, a_2, \dots a_n)$があるとき、その多項式の値が偶然0になる確率は
> 各$a$の値域をmod(なるべく大きい素な数)とすると
> $$
\begin{align}
 Pr(p(a_1, a_2, \dots a_n)=0) \leq \frac{dep(p)}{mod} \\
 (※depは多項式内の最大次数)
 \end{align}
 $$
> となる。

それぞれの集合のハッシュ化方法として、$h(n) = rand(n)$ というように乱数を割り当てる場合、
集合A, Bの多項式は以下とすることができる。
$$
\begin{align}
p_A &= h(x_1) + h(x_2) + \dots + h(x_n) \\
p_B &= h(y_1) + h(y_2) + \dots + h(y_n)
\end{align}
$$
これが衝突する確率を知りたいので、
$$
p = p_A - p_B
$$
としたとき、これが0になる場合それが$\frac{dep(p)}{mod}$以下の確率でたまたま一致した
-> $1-\frac{dep(p)}{mod}$の確信を持って一致していると言える。

$p_A$, $p_B$の多項式の最大次数は1のため、modが十分大きければ十分な確信を持つことができる。